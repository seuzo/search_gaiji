@JunTajimaさんが書かれたエントリ
http://densyodamasii.com/印刷データ→電子書籍で外字化が必要な文字のま/

を拝見して、CIDのリストがあればマーキングできるんじゃないかと思って書きました。たとえばこんな感じ：
<gaiji font="A-OTF リュウミン Pro" fstyle="R-KL" size="9" kind="Variant" cid="8705">髙</gaiji>

出版デジタル機構さんのご用意があるらしいのですが、自分の問題把握のためにコードにしました。
緊デジはShift-JIS対応ですが、EPUB化ではUTF-8になるため画像処理するべき字形は大幅に減ると思います。
合成フォントや欧文フォントがエラーになるため、現在では、日本語フォント以外は最初にスルーするようになっています。
ビブロスフォントは、おそらくUnicode対応できる文字と画像処理するべき文字がありますが、それを別ツールにした方がいいのか、これにまぜて使うかちょっと思案しております。

スクリプトは「スタイルをタグにマップ」したドキュメントを前提にしています。最終的にはXML書出しのためのツールです。
動画：http://youtu.be/5PMhVUbbv58
サンプル：http://bit.ly/KiE64Z

ご意見など頂ければ幸いです。
